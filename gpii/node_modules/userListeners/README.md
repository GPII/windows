# User listeners: Windows specific implementation 

## RFID Listener

`gpii.userListeners.pcsc.windows`

The meat of this implementation is in universal (gpii/node_modules/userListeners). In here it just checks if the
SCardSvr service is running, and provides an instance to the PCSCLite library if so.

Card readers may be added/removed during the lifetime of the GPII process, so if one isn't available at the start then
the user listener will wait for one to be added.

## USB Listener

`gpii.userListeners.usb.windows`

The [WM_DEVICECHANGE](https://msdn.microsoft.com/library/aa363480) message is captured, by creating a window to accept
messages).

This handles the [DBT_DEVICEARRIVAL](https://msdn.microsoft.com/library/aa363205) and
[DBT_DEVICEREMOVECOMPLETE](https://msdn.microsoft.com/library/aa363208) events which provide the drive letters of the
USB device.

## Proximity Listener

`gpii.windows.userListeners.proximity`

Invokes C# code to receive tags from a
[ProximityDevice](https://docs.microsoft.com/uwp/api/windows.networking.proximity.proximitydevice)
