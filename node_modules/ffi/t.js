var ref = require('ref')
  , ffi = require('./')
  , assert = require('assert')

var funcPtr = ffi.Callback('int', [ 'int' ], Math.abs)
var func = ffi.ForeignFunction(funcPtr, 'int', [ 'int' ])

function loop() {
  for (var i = 0; i < 100; i++) {
    assert.equal(1234, func(-1234))
  }
  process.nextTick(loop)
}
loop()
