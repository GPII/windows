/*
 * IoD Tests.
 *
 * Copyright 2018 Raising the Floor - International
 *
 * Licensed under the New BSD license. You may not use this file except in
 * compliance with this License.
 *
 * The R&D leading to these results received funding from the
 * Department of Education - Grant H421A150005 (GPII-APCP). However,
 * these results do not necessarily represent the policy of the
 * Department of Education, and you should not assume endorsement by the
 * Federal Government.
 *
 * You may obtain a copy of the License at
 * https://github.com/GPII/universal/blob/master/LICENSE.txt
 */

"use strict";

var fluid = require("gpii-universal");
var kettle = fluid.require("kettle");
kettle.loadTestingSupport();
var jqUnit = fluid.require("node-jqunit");
var gpii = fluid.registerNamespace("gpii");

fluid.registerNamespace("gpii.tests.windows.iod");

require("../index.js");

jqUnit.module("gpii.tests.windows.iod");


jqUnit.asyncTest("install tests", function () {

    gpii.iod({
        gradeNames: ["gpii.lifecycleManager", "gpii.journal"],
        components: {
            packageDataFallback: {
                type: "kettle.dataSource.file",
                options: {
                    gradeNames: "kettle.dataSource.file.moduleTerms",
                    "path": "%gpii-universal/testData/gpii-iod/%packageName.json5",
                    "termMap": {
                        "packageName": "%packageName"
                    }
                }
            }
        }
    });

    // iod.requirePackage("wget").then(function () {
    //     fluid.log("complete");
    //     jqUnit.start();
    // }, jqUnit.fail);

    jqUnit.assert("Instantiation did not crash");
    jqUnit.start();
});
