/*
 * WmiSettingsHandler - Brightness
 *
 * Copyright 2018 Raising the Floor - US
 *
 * Licensed under the New BSD license. You may not use this file except in
 * compliance with this License.
 *
 * You may obtain a copy of the License at
 * https://github.com/GPII/universal/blob/master/LICENSE.txt
 */

using System;
using System.Threading.Tasks;
using System.Management;

public class Startup {
    public async Task<object> Invoke(object input) {
        // Define scope (namespace)
        ManagementScope scope = new ManagementScope("root\\WMI");
        // Define query
        SelectQuery query = new SelectQuery("SELECT * FROM WmiMonitorBrightness");

        object itemRes = null;
        ManagementObjectSearcher searcher = new ManagementObjectSearcher(scope, query);
        ManagementObjectCollection objectCollection = searcher.Get();
        foreach (ManagementObject mObj in objectCollection) {
            foreach (var item in mObj.Properties) {
                if(item.Name =="CurrentBrightness") {
                    itemRes = item.Value;
                }
            }
        }
        return itemRes;
    }
}
