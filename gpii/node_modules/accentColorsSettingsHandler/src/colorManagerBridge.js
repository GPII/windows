/*
 * GPII Windows 10 Accent Colors Settings Handler
 *
 * Copyright 2018 Raising the Floor - US
 *
 * Licensed under the New BSD license. You may not use this file except in
 * compliance with this License.
 *
 * You may obtain a copy of the License at
 * https://github.com/GPII/universal/blob/master/LICENSE.txt
 */

"use strict";

var path = require("path"),
    // This conditional require is to run the electron version of edge.js
    // when this code runs on electron (gpii-app).
    edge = process.versions.electron ? require("electron-edge-js") : require("edge-js"),
    fluid = require("gpii-universal");

var windows = fluid.registerNamespace("gpii.windows");
fluid.registerNamespace("gpii.windows.accentColor");

require("../../systemSettingsHandler/src/systemSettingsHandler.js");

windows.accentColor.colorManager = edge.func({
    source: path.join(__dirname, "colorManager.csx"),
    references: ["System.Management.dll"]
});

windows.accentColor.setSystemSettings = function (request) {
    var pRes = fluid.promise();

    try {
        pRes = windows.systemSettingsHandler.setImpl(request);
    } catch (err) {
        pRes.reject("sysColorSettingsHandler: 'setSystemSettings' failed with error - '" + err + "'");
    }

    return pRes;
};

windows.accentColor.getSystemSettings = function (request) {
    var pRes = fluid.promise();

    try {
        pRes = windows.systemSettingsHandler.getImpl(request);
    } catch (err) {
        pRes.reject("sysColorSettingsHandler: 'setSystemSettings' failed with error - '" + err + "'");
    }

    return pRes;
};
